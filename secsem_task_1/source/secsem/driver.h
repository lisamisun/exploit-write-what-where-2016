#pragma once

#include <vadefs.h> // for uintptr_t

const auto g_deviceName = L"\\Device\\SECSEM_task";
const auto g_SymbolicLinkName = L"\\??\\SECSEM_task";

#define SECSEMIOCTL_TYPE 50000

#define IOCTL_TASK1 \
    CTL_CODE( SECSEMIOCTL_TYPE, 0x901, METHOD_BUFFERED, FILE_ANY_ACCESS  )

#define IOCTL_TASK2 \
    CTL_CODE( SECSEMIOCTL_TYPE, 0x902, METHOD_BUFFERED, FILE_ANY_ACCESS  )

#define IOCTL_TASK3 \
    CTL_CODE( SECSEMIOCTL_TYPE, 0x903, METHOD_BUFFERED, FILE_ANY_ACCESS  )

struct TASK_1 {
  uintptr_t what_;
  uintptr_t where_;
};

struct TASK_2 {
  uintptr_t what_;
};

struct TASK_3 {
  int allocation_size_;
  int memcpy_buffer_size_;
  int buffer_[1];
};
